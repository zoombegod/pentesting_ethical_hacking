### Initial Intel

```
systeminfo | findstr /B /C:"OS Name" /C:"OS Version"
hostname

```

#### Current User
```
whoami /all
```

#### All Users
```
net user
```


#### Files
```
type %SYSTEMDRIVE%\boot.ini
type %WINDIR%\win.ini
type %WINDIR%\System32\drivers\etc\hosts
```

#### Host Information
```
systeminfo
driverquery
tasklist
fsutil fsinfo drives
set
qwinsta
net time
net file
net session
net use
```

#### Services
```
sc queryex type= service state= all
netstat -ano
netstat -ano | findstr “127.0.0.1”

Get-WmiObject win32_service | Select-Object Name, State, PathName | Where-Object {$_.State -like 'Running'}                               

icacls "C:\Program Files\Serviio\bin\ServiioService.exe"
# F Full access
# M Modify access
# RX Read and execute access
# R Read-only access
# W Write-only access
```
#### Query a specific service:
```
sc query <SERVICE NAME>
```
#### Start a service:
```
sc start <SERVICE NAME>
```
#### Stop a service:
```
sc stop <SERVICE NAME>
```
#### Kill a Task
```
taskkill f /pid 1337
```
#### List System Logs
```
wevtutil el
```
#### Delete Logs
```
del \*.log /a /s /q /f
```
#### Scheduled Tasks
```
schtasks /query /fo LIST /v
```
#### Installed Software
```
wmic product get name /value
```
#### Uninstall Software
```
wmic product where name="<NAME>" call uninstall /INTERACTIVE:OFF
```
#### Search for Keywords (e.g *pass)
```
dir /s *pass* == *key* == *vnc* == *.config*
```
#### The above also looks for key, vnc and config.
#### Only in certain files…
```
findstr /si pass *.xml *.ini *.txt
```
#### Grep Registries…
```
reg query HKLM /f pass /t REG_SZ /s
reg query HKCU /f pass /t REG_SZ /s
```
#### WiFi Clear Text Passwords
#### Find AP SSID
```
netsh wlan show profile
```
#### Get Cleartext Pass
```
netsh wlan show profile <SSID> key=clear

```

### Domain
```
net user /domain  
net group /domain  
net group /domain <Group Name>  
```
## Check RID
```
wmic useraccount where (name='Guest') get name,sid
```
## Network Info
### Firewall  
```
netsh firewall show state  
netsh firewall show config  
netsh advfirewall show currentprofile
netsh advfirewall firewall show rule name=all
```
### Network Details
```
ipconfig /all  
route print  
arp -A  
netstat -ano
```
## Find Readable/Writable Files and Directories
```
accesschk.exe -uws "Everyone" "C:\Program Files"

Get-ChildItem "C:\Program Files" -Recurse | Get-ACL | ?{$_.AccessToString -match "Everyone\sAllow\s\sModify"}
```

## Show Unmounted Disks
```
mountvol

mountvol c:\test \\?\Volume{93131ba8-0000-0000-0000-100000000000}\
```

## Scheduled Tasks  
### Basic info
```
schtasks /query /fo LIST
```

### List only task names
```
schtasks /query /fo LIST 2>nul | findstr TaskName
```

### Verbose
```
schtasks /query /fo LIST /v  
```
### Parsing Verbose output
*copy output and save in txt on kali machine*  
```
cat schtask.txt | grep "SYSTEM\|Task To Run" | grep -B 1 SYSTEM  
```

